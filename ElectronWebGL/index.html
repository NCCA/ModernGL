<!doctype html>
<html>
<head>
  <title>WebGL 2 Triangle</title>

</head>
   <body>
     <H1>WebGL 2 and GLSL 3.0 ES Demo</H1>
      <canvas width = "640" height = "480" id = "GLCanvas"></canvas>
		
      <script>
         var canvas = document.getElementById('GLCanvas');
         var gl = canvas.getContext('webgl2');

         var size = 0.8;
    
         var vao = gl.createVertexArray();
         gl.bindVertexArray(vao);

         var vertices=[-size, -size, 0.0,0 ,size,0.0,size, -size,0.0];

         // Create a new buffer object
         var vertexBuffer = gl.createBuffer();
         // Bind an empty array buffer to it
         gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
         // Pass the vertices data to the buffer
         gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);

         gl.vertexAttribPointer(0, 3, gl.FLOAT, false, 0, 0);
        //Enable the attribute
         gl.enableVertexAttribArray(0);
                
        
         var colours=[1.0,0.0,0.0, 
                      0.0,1.0,0.0,
                      0.0,0.0,1.0];

         // Create a new buffer object
         var colourBuffer = gl.createBuffer();
         // Bind an empty array buffer to it
         gl.bindBuffer(gl.ARRAY_BUFFER, colourBuffer);
         // Pass the vertices data to the buffer
         gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(colours), gl.STATIC_DRAW);

        //point an attribute to the currently bound VBO
        gl.vertexAttribPointer(1, 3, gl.FLOAT, false, 0, 0);
        //Enable the attribute
        gl.enableVertexAttribArray(1);


         // Unbind the buffer
         gl.bindBuffer(gl.ARRAY_BUFFER, null);

         /* load Shaders */

         // Vertex shader source code
         var vertCode =`#version 300 es
            layout(location=0) in vec3 inVert;
            layout(location=1) in vec3 inColour; 
            out vec3 outColour; 
            void main() 
            {
              gl_Position = vec4(inVert, 1.0);  
              outColour=inColour;
            }`;

         //Create a vertex shader object
         var vertShader = gl.createShader(gl.VERTEX_SHADER);

         //Attach vertex shader source code
         gl.shaderSource(vertShader, vertCode);

         //Compile the vertex shader
         gl.compileShader(vertShader);
         var message = gl.getShaderInfoLog(vertShader);

          if (message.length > 0) {
            /* message may be an error or a warning */
            console.log( message);
          }

         //Fragment shader source code
         var fragCode = `#version 300 es
         precision highp float;
         layout(location=0) out vec4 fragColour;
         in vec3 outColour;
         void main() 
         {
           fragColour = vec4(outColour, 1);
          }`;

         // Create fragment shader object
         var fragShader = gl.createShader(gl.FRAGMENT_SHADER);

         // Attach fragment shader source code
         gl.shaderSource(fragShader, fragCode);

         // Compile the fragment shader
         gl.compileShader(fragShader);
         message = gl.getShaderInfoLog(fragShader);

          if (message.length > 0) {
            /* message may be an error or a warning */
            console.log( message);
          }

         // Create a shader program object to store combined shader program
         var shaderProgram = gl.createProgram();

         // Attach a vertex shader
         gl.attachShader(shaderProgram, vertShader); 
         
         // Attach a fragment shader
         gl.attachShader(shaderProgram, fragShader);

         // Link both programs
         gl.linkProgram(shaderProgram);

         // Use the combined shader program object
         gl.useProgram(shaderProgram);

         /* Step 4: Associate the shader programs to buffer objects */
         //Bind vertex buffer object
         gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);


         /* Step5: Drawing the required object (triangle) */

         // Clear the canvas
         gl.clearColor(0.8, 0.8, 0.8, 1.0);

         // Enable the depth test
         gl.enable(gl.DEPTH_TEST); 
         
         // Clear the color buffer bit
         gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);

         // Set the view port
         gl.viewport(0,0,canvas.width,canvas.height);
         gl.bindVertexArray(vao);
         // Draw the triangle
         gl.drawArrays(gl.TRIANGLES, 0, 3);
      </script>

      <H2>Explaination</H2>
<p>This simple example uses Web GL 2 and Vertex Array Objects to draw a simple coloured triangle. </p>

<p>The triangle is generated by the following code</p>
<pre><code class="javascript">     
var vao = gl.createVertexArray();
gl.bindVertexArray(vao);

var vertices=[-size, -size, 0.0,0 ,size,0.0,size, -size,0.0];

// Create a new buffer object
var vertexBuffer = gl.createBuffer();
// Bind an empty array buffer to it
gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
// Pass the vertices data to the buffer
gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);

gl.vertexAttribPointer(0, 3, gl.FLOAT, false, 0, 0);
//Enable the attribute
gl.enableVertexAttribArray(0);
        

var colours=[1.0,0.0,0.0, 
              0.0,1.0,0.0,
              0.0,0.0,1.0];

// Create a new buffer object
var colourBuffer = gl.createBuffer();
// Bind an empty array buffer to it
gl.bindBuffer(gl.ARRAY_BUFFER, colourBuffer);
// Pass the vertices data to the buffer
gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(colours), gl.STATIC_DRAW);

//point an attribute to the currently bound VBO
gl.vertexAttribPointer(1, 3, gl.FLOAT, false, 0, 0);
//Enable the attribute
gl.enableVertexAttribArray(1);
</code></pre>


</body>

</html>